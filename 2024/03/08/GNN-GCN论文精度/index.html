<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="GNN/GCN论文精度, April">
    <meta name="description" content="论文链接：
A Gentle Introduction to Graph Neural Networks (distill.pub)
（disdill的文章特点，尽力用图来解释，能看懂图就可以大概理解整个文章）
背景：社交网络流行的时候，图">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>GNN/GCN论文精度 | April</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    
    <style>
        body{
            background-image: url(https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/site/medias/background.jpg);
            background-repeat:no-repeat;
            background-size: 100% 100%;
            background-attachment:fixed;
        }
    </style>



    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.0.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">April</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Medias</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/medias/musics">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Musics</span>
        </a>
      </li>
      
      <li>
        <a href="/medias/movies">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Movies</span>
        </a>
      </li>
      
      <li>
        <a href="/medias/books">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Books</span>
        </a>
      </li>
      
      <li>
        <a href="/medias/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Galleries</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">April</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Medias
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/medias/musics " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>Musics</span>
                  </a>
                </li>
              
                <li>

                  <a href="/medias/movies " style="margin-left:75px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>Movies</span>
                  </a>
                </li>
              
                <li>

                  <a href="/medias/books " style="margin-left:75px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>Books</span>
                  </a>
                </li>
              
                <li>

                  <a href="/medias/galleries " style="margin-left:75px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:50px" ></i>
			      
		          <span>Galleries</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/April17-1" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/April17-1" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/15.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">GNN/GCN论文精度</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2024-03-08
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>论文链接：</p>
<p><a target="_blank" rel="noopener" href="https://distill.pub/2021/gnn-intro/">A Gentle Introduction to Graph Neural Networks (distill.pub)</a></p>
<p>（disdill的文章特点，尽力用图来解释，能看懂图就可以大概理解整个文章）</p>
<h4 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h4><p>社交网络流行的时候，图比较热门，将神经网络应用在图上的现象在逐渐兴起。</p>
<h3 id="1-前言："><a href="#1-前言：" class="headerlink" title="1.前言："></a>1.前言：</h3><p>图是一个很一般化的架构，十几年前，研究者提出了针对图的神经网络（图神经网络，GNN），最近它们在能力和表达上都有增强</p>
<p>图神经网络的实际应用（starting to，图神经网络还是一个比较新的领域，在应用上刚起步）</p>
<p>药物的发现<br>物理模拟<br>虚假新闻检测<br>车流量的检测<br>推荐系统</p>
<p>本文旨在探索和解释现代的图神经网络</p>
<p>什么数据可以表示成一张图<br>图和别的数据有什么不同，为什么要做图神经网络，而不是使用最简单的卷积神经网络等<br>构建了一个GNN，看各模块的具体结构<br>提供了一个GNN的playground </p>
<h1 id="介绍："><a href="#介绍：" class="headerlink" title="介绍："></a>介绍：</h1><h3 id="2-什么是图"><a href="#2-什么是图" class="headerlink" title="2.什么是图"></a>2.什么是图</h3><p>图是用来表示entity（实体）之间的关系</p>
<p>实体就是一个点（node，顶点）<br>关系就是一个边（edge）</p>
<p>U：代表整个图（全局信息）<br>attribute：每个顶点、每条边和整个图表示的信息</p>
<p><strong>顶点（黄色）</strong>可以用一个embeding（向量）来表示它里面的属性，一共有六个值，高矮表示值的大小<br><strong>边（蓝色）</strong>也可以使用向量来表示，长度可以和顶点不一样，这里使用的是一个长度为8的向量，即边中所有的属性用一个长度为8的向量来表示<br><strong>全局信息（粉色）</strong>可以用一个长为5的向量来表示</p>
<h4 id="图神经网络所关注的重点"><a href="#图神经网络所关注的重点" class="headerlink" title="图神经网络所关注的重点"></a>图神经网络所关注的重点</h4><p>怎样把所想要的信息表示成向量<br>这些向量是不是能够通过数据来学到 </p>
<h4 id="图一共有两种"><a href="#图一共有两种" class="headerlink" title="图一共有两种"></a>图一共有两种</h4><p>1、没有方向的图</p>
<p>没有方向：两个点之间相连的边是没有方向的<br>例如微信好友</p>
<p>2、有方向的图</p>
<p>例如关注与互关 </p>
<h4 id="数据是如何表示成图的"><a href="#数据是如何表示成图的" class="headerlink" title="数据是如何表示成图的"></a>数据是如何表示成图的</h4><p>1、如何将图片表示成一张图</p>
<p>假设有一张高宽都为244的RGB三通道图，一般来说会把它表示成一个三个维度的tensor（在输入卷积神经网络的时候用的是tensor），但是也可以把它当作一个图，它的每个像素就是一个点，如果两个像素之间是连接关系的话，就连接一条边 </p>
<p>邻接矩阵：很大的稀疏矩阵</p>
<h4 id="如何将文本表示成图？"><a href="#如何将文本表示成图？" class="headerlink" title="如何将文本表示成图？"></a>如何将文本表示成图？</h4><p>文本可以认为是一条序列，可以把其中每个词表示成顶点，那么每个词和下一个词之间有一条有向边（上一个词和下一个词之间有一条指向下一个词的有向边，在图上面叫做有向的路） </p>
<p>除了文本和图片能够表示成图之外，现实生活中还有很多数据也能表示成图：化学分子，大分子高分子；《奥德赛》剧中所有人物之间的交互图 ；空手道俱乐部的社交网络图 </p>
<p><img src="/picture/GNN1.png" alt="GNN1"></p>
<p>grapgh表示图的个数<br>node表示顶点数<br>edge表示边的个数<br>mean表示平均每个点所连接的边的数量<br>min表示图中一个顶点所连接的边的数量的最小值<br>max表示图中一个顶点所连接的边的数量的最大值<br>每一行就是一张图<br>第一行是一个空手道俱乐部的社交网络图 </p>
<h4 id="在图上面可以提出什么样的问题？"><a href="#在图上面可以提出什么样的问题？" class="headerlink" title="在图上面可以提出什么样的问题？"></a>在图上面可以提出什么样的问题？</h4><p>图层面的 </p>
<p>下图左边是一些原始的图，任务是要找出哪些图中含有两个圆环（给定一张图，然后对图进行分类）：</p>
<p><img src="/picture/GNN3.png" alt="GNN3"></p>
<p>这里是一个很简单的问题，不需要使用到机器学习，只需要使用简单的编程，沿着图遍历一下就可以的<br>对于复杂一点的任务，可以借助图神经网络</p>
<p>顶点层面的</p>
<p>空手道俱乐部的社交关系图，假如某一天两个老师不合决裂了，所有的学生要对这两个老师进行站队（站在某一个老师那边） </p>
<p>边层面的</p>
<p>如下图所示，给定一张图片，先通过语义分割及那个图片中的人物、背景拿出来之后，然后判断人物之间的关系（顶点已经有了，需要判断顶点之间的边的属性） </p>
<p><img src="/picture/GNN4.png" alt="GNN4"></p>
<p>总的来说就是三类问题</p>
<p>对整个图进行识别<br>对顶点的属性进行判断<br>对边的属性进行判断</p>
<h4 id="机器学习用在图上会有怎样的挑战？"><a href="#机器学习用在图上会有怎样的挑战？" class="headerlink" title="机器学习用在图上会有怎样的挑战？"></a>机器学习用在图上会有怎样的挑战？</h4><p>虽然标题是机器学习，但是实际上讲的是神经网络</p>
<p><strong>将神经网路用在图上面最核心的问题是：如何表示图使得它能够和神经网络兼容</strong></p>
<p>图上面有四种信息</p>
<p><strong>顶点的属性</strong><br><strong>边的属性</strong><br><strong>全局信息</strong><br><strong>连接性：每条边到底连接的是哪两个点</strong><br>前三个比较容易，因为都能够使用向量来进行表示，神经网络对向量是友好的，问题在于如何表示连接性</p>
<p>连接性可以用邻接矩阵来表示</p>
<p>如果有n个顶点的话，邻接矩阵就是n*n的矩阵，其中如果两个顶点直接相连的话值就为1，否则为0，这样就能得到一个方形的矩阵</p>
<p>但是用邻接矩阵来表示连接性的话也存在很多问题</p>
<p>邻接矩阵可能会非常大：按照正常的存放可能存不下，由于它是一个稀疏矩阵，可以用稀疏矩阵的形式来进行存储，使得它至少在存储上是可行的。但是如果处理稀疏矩阵的话，高效地处理稀疏矩阵比较困难，特别是将稀疏矩阵用在GPU上面，一直是一个比较难的问题<br>邻接矩阵其实将任何行或者列的顺序交换都不会影响，视觉上可能是不一样的，但是其实表示的是同一种东西，这就意味着如果设计一个神经网络不管使用哪种顺序，放进神经网络之后都应该保证最后的结果是一样的（因为不同的顺序的邻接矩阵其实表示的是同一张图），有点类似于化学中的同分异构体</p>
<p>如果说既想要存储高效，又想要排序不影响最终结果的话，文中提出了一种存储方法，如下图所示 </p>
<p><img src="/picture/GNN2.png" alt="GNN2"></p>
<p>图中一共有8个顶点，7条边</p>
<ul>
<li>每个点的属性使用的是一个标量来表示（也可以换成向量，并不影响）</li>
<li>每一条边也是用一个标量来表示的（也可以换成向量，并不影响）</li>
<li>全局的信息也是用一个标量来进行表示的（也可以换成向量，并不影响）</li>
<li>邻接列表：长度和边数一样，第 i 项表示第 i 条边连接的两个顶点</li>
<li>存储高效：这样在存储上，只把边和所有属性存储下来</li>
<li>与顺序无关：可以把边的顺序任意打乱，只要把连接列表的顺序也进行相应的变化就可以了。同理。也以将顶点的顺序全部打乱，只要将邻接列表中的数字做相应 的更新就可以了</li>
<li>所以这样存储即使存储高效的，也是与顺序无关的</li>
</ul>
<h3 id="3-图神经网络"><a href="#3-图神经网络" class="headerlink" title="3.图神经网络"></a>3.图神经网络</h3><h4 id="图神经网络的定义"><a href="#图神经网络的定义" class="headerlink" title="图神经网络的定义"></a>图神经网络的定义</h4><p>GNN是对图上所有的属性（包括顶点、边和全局上下文）进行的可以优化的变换，这个变换能够保持住图的对称信息（对称信息指的是将顶点进行另外一种排序信息之后，整个结果不会发生改变）</p>
<p>message passing（信息传递神经网络，GNN也可以用别的神经网络来进行描述，这个地方用的是信息传递的框架）</p>
<p>GNN的输入是图，输出也是图，它会对顶点、边和全局的向量进行变换，但是不会改变图的连接性（顶点和边的连接信息在进入图神经网络之后是不会改变的）</p>
<h4 id="构造一个最简单的GNN"><a href="#构造一个最简单的GNN" class="headerlink" title="构造一个最简单的GNN"></a>构造一个最简单的GNN</h4><p>如下图所示，对于顶点向量、边向量和全局向量分别构造MLP（多层感知机），MLP的输入大小和输出大小相同，取决于输入的向量</p>
<p><img src="/picture/GNN5.png" alt="GNN5"></p>
<ul>
<li><p>fUn表示全局向量的MLP</p>
</li>
<li><p>fVn表示顶点的MLP</p>
</li>
<li><p>fEn表示边的MLP</p>
<p>  这三个MLP组成了GNN的层。这个层的输入是图，输出还是图，如下图所示，它的作用是：对于顶点向量、边的向量和全局的向量分别找到对应的MLP，然后将它们放进去得到它们的输出，作为其对应的更新，图进去再出来之后的属性都是被更新过的，但是整个图的结构没有发生变化（只对属性集变化，但是不改变图的结构）</p>
<p>  因为MLP是对每个向量独自作用的而不会考虑所有的连接信息，所以不管对整个顶点做任何排序信息都不会改变结果所以这个最简单的层就满足了之前的两个要求，也可以将这些层叠加在一起构造成比较深的GNN</p>
</li>
</ul>
<h4 id="最后一层的输出怎样得到想要的预测值？"><a href="#最后一层的输出怎样得到想要的预测值？" class="headerlink" title="最后一层的输出怎样得到想要的预测值？"></a>最后一层的输出怎样得到想要的预测值？</h4><p>首先考虑最简单的情况：已知顶点向量，对每个顶点做预测</p>
<p>和一般的神经网络没有太多区别，因为顶点已经表示成向量了，然后要对它做预测的话，比如前述的空手到俱乐部的问题，其实就是一个简单的二分类问题</p>
<ul>
<li><p>每个学生已经有了对应的向量表示</p>
</li>
<li><p>在后面加一个输出为2的全连接层，然后再加一个softmax就能得到输出了</p>
<p>如果是做n类的话，就加一个输出大小是n的全连接层，然后再加一个softmax就能得到多类输出了</p>
</li>
</ul>
<p>做回归的话就是单输出就行了</p>
<p>如下图所示，给定最后一层的输出是一个图，然后对于每一个顶点进入到全连接层，然后得到输出，这样就会对顶点作分类</p>
<p><img src="/picture/GNN6.png" alt="GNN6"></p>
<p>注意：和之前一样，不管有多少个顶点，只有一个全连接层（所有的顶点将会共享一个全连接层里面的参数）。在之前的GNN层里面，不管图有多大，一层里面也就是3个MLP，所有的顶点、边共享一个MLP，全局就一个就不用共享了</p>
<p>再考虑一个稍微复杂一点的情况</p>
<p>还是对顶点做预测，但是顶点并没有表示成向量</p>
<p>pooling（汇聚）：和CNN中的pooling其实没有太多本质上的区别</p>
<h4 id="假设某个点没有自己的向量，如何得到它的向量并做预测？"><a href="#假设某个点没有自己的向量，如何得到它的向量并做预测？" class="headerlink" title="假设某个点没有自己的向量，如何得到它的向量并做预测？"></a>假设某个点没有自己的向量，如何得到它的向量并做预测？</h4><p>可以把跟这个点连接的那些边和全局的向量拿出来，就会拿出五个向量，如下图所示</p>
<p><img src="/picture/GNN7.png" alt="GNN7"></p>
<ul>
<li>箭头表示对应的向量</li>
<li>中间的值是一个全局向量，所以没有写出来</li>
<li>将5个向量全部加起来，就会得到代表这一个点的向量（这里假设所有的顶点、边和全局向量的维度是一样的，如果不一样的话则需要做投影）</li>
<li>最后加上一个全连接层就能得到输出了，如下图所示</li>
</ul>
<p><img src="/picture/GNN8.png" alt="GNN8"></p>
<ul>
<li>上图表示只有边的向量En，没有顶点的向量Vn，通过汇聚层（从边到顶点），每个顶点都会得到自己的向量</li>
<li>最后进入到顶点之间共享的输出层就能得到顶点的输出了</li>
</ul>
<p>同理，假设没有边的向量只有顶点的向量但是想对每个边做预测的情况如下图所示</p>
<p><img src="/picture/GNN9.png" alt="GNN9"></p>
<ul>
<li>可以把顶点的向量汇聚到边上（一条边连接两个顶点，可以把这两个顶点加起来，也可以加上全局向量），得到对应的边的向量</li>
<li>然后进入边向量的输出层（所有的边共享一个输出层），最后得到边的输出</li>
</ul>
<p>最后假设没有全局的向量，但是有顶点的向量然后对整个图做预测的情况</p>
<p><img src="/picture/GNN10.png" alt="GNN10"></p>
<ul>
<li>可以把所有顶点向量加起来，得到对应的全局向量</li>
<li>然后进入全局的输出层，输出层会得到全局的输出</li>
</ul>
<p>综上所述，不管缺乏哪一类的属性，都可以通过汇聚操作得到所缺失的属性的向量，最后得到预测值</p>
<p>总结上面的内容，就能得到一个简单的GNN，如下图所示</p>
<p><img src="/picture/GNN11.png" alt="GNN11"></p>
<ul>
<li>给定一个输入图，首先进入一系列的GNN层（每个层里面有三个MLP，对应三种不同的属性），会得到一个保持整个图结构的输出（但是里面所有的属性已经进行了更新）</li>
<li>最后根据所要预测的属性添加合适的输出层</li>
<li>但如果缺失信息的话可以加入合适的汇聚层就可以完成预测了</li>
<li>这是最简单的情况。虽然这个情况很简单，但是有很大局限性，主要的问题在于在GNN块中并没有使用图的结构信息（对每个属性做变换的时候，仅仅是每个属性进入自己对应的MLP，并没有体现出三者之间的相互联系的连接信息），导致并没有合理地把整个图的信息更新到属性里面，以至于最后的结果并不能够特别充分利用图的信息</li>
</ul>
<p>如何对上述问题进行改进使得能够将图的信息尽早放进去</p>
<p>信息传递，工作原理如下图所示</p>
<p><img src="/picture/GNN12.png" alt="GNN12"></p>
<ul>
<li>首先将上图中橙色实心顶点的向量和它的邻居的两个顶点的向量加在一起得到一个汇聚的向量</li>
<li>再将这个汇聚的向量放进MLP得到该顶点向量的更新</li>
<li>其他顶点的操作同理（拿到每个顶点本身的向量以及它邻居的向量加到一起，最后得到进入MLP之前的汇聚向量）</li>
<li>聚合步</li>
<li>更新步</li>
<li>这是一个最简单形式的信息传递</li>
<li>这个跟标准的图片上的卷积有点类似，等价于在图片上做卷积，但是卷积核窗口里面每个窗口的权重是要相同的（因为在卷积里面其实是每一个顶点和它邻居顶点的向量会做加权和，权重来自于卷积窗口），这里没有加权和，只是加，所以权重应该是一样的，但是通道还是保留了（卷积中有多输入通道和多输出通道，对应信息传递过程中MLP还是保留了），所以和卷积操作有点类似，但是还是有区别<br>GNN层也可以通过堆叠来完成整个图的长距离信息传递过程</li>
</ul>
<p>下图表示一个顶点，顶点之间通过距离为1的邻居（一近邻）将它的信息传递过来，就 ρ 从 v 到 v 的汇聚过程，这也是最简单的信息传递的过程</p>
<p><img src="/picture/GNN13.png" alt="GNN13"></p>
<p>再复杂一点，之前考虑过，假设确实某种属性，可以从别的属性汇聚过来，以弥补这个属性，同理，不需要等到最后一层在进行汇聚，可以在较早的时候在边和顶点之间汇聚信息</p>
<p>下图展示了如何将顶点的信息传递给边，然后再把边的信息传递给顶点</p>
<p><img src="/picture/GNN14.png" alt="GNN14"></p>
<ul>
<li>首先通过ρ（V to E）把顶点的向量传递给边（把每个边连接的顶点信息加到边的向量中，假设维度不一样的话，会先做投影，投影到同样的维度然后再加进去，这样边就拿到了顶点的信息）</li>
<li>同样可以每个顶点可以把连接它的边的信息也加到自己上面，同样维度不同的话，可以先做投影（这里如果维度不一样的话，会做两次投影），维度一样的可以直接相加</li>
<li>另外也可以将它contact在一起，也就是并在一起（类似于矩阵的拼接操作）</li>
<li>这样就完成了顶点到边的传递、边到顶点的传递之后，再进入到各自的MLP做更新</li>
<li>这里是先把顶点的信息传递给边做更新，然后再把更新过信息的边的信息汇聚到顶点再做更新，如下图左图所示。如果反过来的话会得到不一样的结论如下图右图所示</li>
</ul>
<p><img src="/picture/GNN15.png" alt="GNN15"></p>
<ul>
<li>之前顶点和边之间不交换任何信息，各自进行更新，所以谁先进行更新不影响</li>
<li>但是现在先更新顶点还是先更新边会导致不一样的结果，目前来说还没有一致的结论说说先更新谁比较好，只是说这两种会导致不一样的结果</li>
<li>其实可以交替更新，如下图所示：同时顶点汇聚到边然后边汇聚到顶点，汇聚之后先不要相加，然后再回来一次，就相当于两边的信息都有了，等价于两个信息同时汇聚，最终向量可能会宽一点，这样就不用担心到底是先做谁的汇聚了</li>
</ul>
<h4 id="全局信息相关"><a href="#全局信息相关" class="headerlink" title="全局信息相关"></a>全局信息相关</h4><p>之前有一个问题：因为每次只去看自己的邻居，假设图比较大而且连接没那么紧密的时候，会导致信息从一个点传递到一个很远的点需要走很长的步</p>
<p>解决方案：加入master node（或者叫context vector），这个点是虚拟的点，可以跟所有的顶点相连，也可以跟所有的边相连（这里在图上面不好说，因为一个顶点是没办法跟边相连的，在这里是一个抽象的概念），它其实就是U，U跟所有的V里面的东西是相连的，跟E里面所有的东西也是相连的，所以如果想要把顶点的信息汇聚给边的时候，也会把U汇聚过来，因为U跟边是相连的（同理，汇聚顶点的时候，也会把U和它相连的E连过来），最后自己更新U的时候，会把所有的顶点信息和边的信息都拿过来，最后完成汇聚再做更新</p>
<p><img src="/picture/GNN16.png" alt="GNN16"></p>
<p>到此，这三类属性都学到了对应的向量，而且这些向量在早期就已经进行了大量的信息传递，最后在做预测的时候就可以只用本身的向量，也可以把相邻的那些边的向量也拿过来，甚至是把跟他相邻的那些顶点的向量也拿过来，以及全局向量，也就是说不仅使用本身的向量，还可以将别的跟本身相关的东西都拿过来一起做预测</p>
<p>对于来自于不同类别的属性，可以加在一起，合并在一起也可以。有一点像注意力机制（attention就是说将当前query的顶点和跟他相近的东西都拿过来，可以直接用图的信息将这些相近的向量拿过来，这样就完成了基于消息传递的图神经网络的工作）</p>
<h3 id="4、实验"><a href="#4、实验" class="headerlink" title="4、实验"></a>4、实验</h3><p>这部分是一个GNN的playgrround，作者吧GNN的训练程序嵌入到了javascript里面，然后做了一个比较小的分子图的预测数据集，使得可以调节图神经网络里面不同的超参数，来观察实际的训练效果（整个过程是在浏览器中运行的，不需要安装任何额外的程序）</p>
<p>可调节的超参数：</p>
<p>图神经网络的层数：1层～4层<br>汇聚操作的方式：mean（每个向量按元素做平均，对应卷积神经网络中的average pooling）、sum（每个向量按元素求和，求和在卷积神经网络中用的不多）、max（每个向量按元素取最大值，对应卷积神经网络中的max pooling）<br>顶点的size：25、50、100（也可以取消勾选不学）<br>边的size：5、10、20（也可以取消勾选不学）<br>全局向量的size：25、50、100（也可以取消勾选不学）</p>
<p>每次改变一个超参数，它就会重新对数据进行一次训练，训练使用的是50个epoch，训练完之后会显示auc（越大越好），每次可以调节不超参数得到不一样的结果</p>
<p>下图右侧是对所有数据点的预测</p>
<p><img src="/picture/GNN17.png" alt="GNN17"></p>
<ul>
<li>真实值的颜色用边框表示，预测值用实心里面的颜色表示</li>
<li>边框有两个颜色，一个是红色，一个是蓝色，表示两类</li>
<li>里面填的东西是预测值</li>
<li>如果边框和实心都是红色或者蓝色的话，则预测是正确的，否则的话就是错误的</li>
<li>这里是对每个分子图的向量投影到二维之后可视化的效果</li>
<li></li>
<li>左边可以做预测，实时地对给定的图做预测</li>
<li>可以对图进行改变，可以多连一点边出来或者改变某一个节点的原子</li>
<li>改变之后可以实时观察预测值是多少然后在整个数据点上长什么样子</li>
</ul>
<p>超参数比较难调，作者给出了很多超参数对最后精度的影响</p>
<p>下图表示的是模型可以学习参数的大小和最后测试的auc之间的关系</p>
<p><img src="/picture/GNN18.png" alt="GNN18"></p>
<ul>
<li>每一个点就是一个特定的超参数在模型训练之后得到的结果，所以一个点就是一个模型</li>
<li>x轴是参数的个数</li>
<li>y轴表示auc，auc越高越好</li>
<li>整体来说，模型参数变高的时候，模型的auc的上限是上涨的，就算模型很大，参数也得调的比较好，不然也可能达不到很好的效果（也可能跟小模型具有一样的效果）</li>
</ul>
<p>具体每一个超参数对整个模型的影响，请参考原文。</p>
<p>总的来说，GNN对超参数还是比较敏感的，能调的超参数也很多</p>
<p>GNN的层数<br>每一个属性的大小<br>汇聚的操作方式<br>信息的传递方式<br>上述因素都对参数传递造成了很大的影响</p>
<h2 id="5、相关技术"><a href="#5、相关技术" class="headerlink" title="5、相关技术"></a>5、相关技术</h2><p>这部分讨论了一些跟GNN相关的技术话题</p>
<p>除了上文中提到的图，其实还有很多别的图，如下图所示</p>
<p><img src="/picture/GNN19.png" alt="GNN19"></p>
<ul>
<li>左图是一个multi graph：顶点之间可以有多条边，比如左图中相同顶点之间不同颜色的边表示不同种类的边（红色的无相边、绿色的有相边）</li>
<li>右图表示图可能是分层的：其中有一些顶点可以能是一个子图（hypernode）</li>
<li>不同的图结构会对神经网络做信息汇聚的时候产生影响</li>
</ul>
<p><strong>怎样对图进行采样和做batch？</strong></p>
<p>假设有很多层的时候，最后一层的顶点就算只看它的一近邻，最后顶点由于有很多层消息传递，所以它实际上是能看到一个很大的图，在图连通性足够的情况下，最后这个顶点有可能会看到整个图的信息</p>
<p>在计算梯度的时候，需要把整个forward中所有的中间变量存下来，如果最后一层的顶点想要看整个图的话，意味着在算梯度的时候需要把整个图的中间结果都存下来，就导致计算量大到无法承受，因此就需要对图进行采样</p>
<p>在图中每次采样一个小图出来，在这个小图上做信息的汇聚，这样算梯度的时候就只需要将小图上的中间结果记录下来就行了</p>
<p>采样方法</p>
<p><img src="/picture/GNN20.png" alt="GNN20"></p>
<ul>
<li><p>左图表示随机采样一些点，然后将这些点最近的邻居找出来</p>
</li>
<li><p>左图中采样了4个黄色的点，然后把它们的邻居（红色点）找了出来，在做计算的时候，只在这个子图上做计算，通过控制每次采样的点的数量，可以防止采样的子图过大，以保证内存能够将所有的中间变量存下来</p>
</li>
<li><p>右图表示随机游走采样：从某个一个顶点开始，然后随机在图中找到一条边，然后沿着这条边走到下一个顶点，按照这种方式在图中随机游走</p>
</li>
<li><p>可以通过规定随机游走的步数，来得到子图</p>
</li>
<li></li>
<li><p>左下角的图表示以上两种方式的结合：先随即走三步，然后把这三步每个点的邻居找出来</p>
</li>
<li><p>右下角的图表示取一个顶点，然后将它的一近邻、二近邻、三近邻往前走k步做一个宽度遍历，然后把所得到的子图拿出来</p>
<p>以上四种采样方法，具体哪一种使用效果比较好，取决于整个图的样子</p>
</li>
</ul>
<p>如何做batch？</p>
<p>从性能上考虑，不希望对每一个顶点逐步逐步更新，这样每一步的计算量太小，不利于并行，希望是像别的神经网络一样，将小样本做成小批量，这样来对大的矩阵或者tensor做运算</p>
<p>这里存在一个问题：每一个顶点的邻居的个数是不一样的，如何将这些顶点的邻居通过合并变成一个规则的张量是一个具有挑战性的问题</p>
<p>inductive biases</p>
<p>任何一个神经网络，或者说任何一个机器学习的模型中都存在假设</p>
<ul>
<li>卷积神经网络假设的是空间变换的不变性</li>
<li>循环神经网络假设的是时序的延续性</li>
<li>图神经网络假设的是：保持了图的对称性（不管怎样交换顶点的顺序，GNN对图的作用都是保持不变的）</li>
</ul>
<p>不同汇聚操作的比较</p>
<p>汇聚操作包括求和、求平均或者求max，但是其实没有一种是特别理想的（要根据实际情况而定）</p>
<p>GCN作为子图的函数近似</p>
<p>GCN是graph convolutional network（图卷积神经网络），就是上面提到的那个带汇聚操作的图神经网络</p>
<ul>
<li>GCN如果有k个层，每一层都是看一个它的邻居的话，就等价于在卷积神经网络里面有k层3*3的卷积。如果是这样的话，每一个最后一层看到的顶点是一个大小为k的子图（最远的顶点距离当前这个点的距离是k，因为每经过一层就相当于往前看了一步），这样的话可以认为每个点都是看以自己为中心往前走k步的子图的信息的汇聚</li>
<li>所以从一定程度上来说，GCN可以认为是：n个以自己为中心往前走k步的子图，最后求embeding</li>
</ul>
<p>将点和边做对偶</p>
<p>图论：可以把点变成边、边变成点，邻接关系表示保持不变，这种变换在GNN上也可以使用</p>
<p>图卷积和矩阵乘法的关系（如何高效实现整个图神经网络的关键点）</p>
<p>在图上做卷积或者做random work，等价于将它的邻接矩阵拿出来做矩阵乘法</p>
<p>page rank就是在一个很大的图上面随机游走，将邻接矩阵和一个向量不断地做乘法</p>
<p>graph attention network</p>
<p>在图上做汇聚的时候是每个顶点和它邻接的顶点的权重加起来，但是如果是做卷积的话是做加权和，同理，在图上也可以做加权和，但是需要注意卷积的权重是跟位置相关的（每个3*3的窗口固定的点上有固定的权重），而对于图来说不需要有位置信息（因为每个顶点的邻居个数不变，而且邻居是可以随意打乱顺序的，权重对位置信息是不敏感的）,所以可以用注意力机制，权重取决于两个顶点向量之间的关系，而不是顶点的位置，在使用attention之后，可以给每个顶点一个权重，再按这个权重加起来就得到了一个graph attention network</p>
<p>图的可解释性</p>
<p>在图上面训练了一个模型之后，怎么理解它学到的东西</p>
<p>可以将子图中的信息抓取出来，看它到底学到的是什么信息</p>
<p>generative modeling</p>
<p>图神经网络是不改变图的结构的，如果想要生成图，怎样对图的拓扑结构进行有效的建模，提出了一些算法</p>
<h3 id="6、评论"><a href="#6、评论" class="headerlink" title="6、评论"></a>6、评论</h3><p>写作</p>
<ul>
<li>首先介绍了什么是图（图的属性（顶点、边、全局）应该用向量来表示），然后介绍了现实生活中的数据如何表示成图，怎样对图（顶点、边、整个图）做预测，机器学习的算法用到图上的时候有一些怎样的挑战</li>
<li>然后开始讲GNN：首先对GNN下定义（GNN就是对属性做变换，但是不改变图的结构），然后给了一个最简单的例子（用三个全连接层对每个属性单独做变换，再加一个输出层来做预测），再介绍如何解决数据的缺失问题（聚合操作来弥补缺失的属性）</li>
<li>然后开始介绍什么是真正意义上的GNN，在每一层中通过汇聚操作将整个信息传递过来（每个顶点去看它邻接顶点的信息，以及看它邻接边的信息或者是全局信息），在每个层中如果能够充分地汇聚图上的信息，GNN就能很有效地对整个图的结构进行发掘</li>
<li>接下来是实验部分：对不同的超参数在数据集上得出了很多结果，然后总结了每个超参数对结果的影响</li>
<li>最后对GNN相关的问题进行了展开</li>
<li>这个文章的特点是图很漂亮，制作精美，而且基本上都是交互图（交互图可以把很多信息都放进去，使得图既不是很脏，读者又能通过图获得很多东西）</li>
</ul>
<p>缺点</p>
<ul>
<li>图既是优点也是缺点，这种交互图制作非常困难，导致写作门槛比较高</li>
<li>作者可以避免用公式和代码来对一个问题进行描述，而是大量地使用图和文字。有时候使用公式其实更加简洁准确，代码可以体现出很多细节上的东西，最好能结合公式、代码、图多维度描写</li>
<li>最后一节宽度的展开有一点画蛇添足，前面已经讲得很好了，但是后面又做了展开，每一个展开并没有讲清楚细节</li>
</ul>
<p>图神经网络</p>
<ul>
<li>图是一个非常强大的工具，基本上所有的数据都能够表示成图，但也存在问题：在图上进行优化非常困难，因为图是稀疏架构，每个结构都是动态结构，使得计算比较困难</li>
<li>图神经网络对超参数是非常敏感的</li>
<li>上述两个原因导致图神经网络的门槛比较高，在工业上的应用依然比较少</li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">April</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://april17-1.github.io/2024/03/08/GNN-GCN%E8%AE%BA%E6%96%87%E7%B2%BE%E5%BA%A6/">https://april17-1.github.io/2024/03/08/GNN-GCN%E8%AE%BA%E6%96%87%E7%B2%BE%E5%BA%A6/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">April</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2024/03/08/GNN-GCN%E8%AE%BA%E6%96%87%E7%B2%BE%E5%BA%A6/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="GNN/GCN论文精度">
                        
                        <span class="card-title">GNN/GCN论文精度</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-03-08
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            April
                            
                        </span>
                    </div>
                </div>

                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2024/02/20/Transformer%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="Transformer论文精读">
                        
                        <span class="card-title">Transformer论文精读</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-02-20
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            April
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2024</span>
            
            <a href="/about" target="_blank">April</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2019";
                        var startMonth = "6";
                        var startDate = "28";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/April17-1" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2200482038@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2200482038" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2200482038" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    
        
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/sakura.js"><\/script>');
            }
        </script>
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
